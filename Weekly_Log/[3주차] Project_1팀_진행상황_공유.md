## 팀 구성원, 개인 별 역할

---

 

| 정동은 | 인증, 회원가입, 로그인, 뱃지, 레벨 시스템 |
| --- | --- |
| 고기욱 | api 분석해서 문서로 정리하기, 듀오 게시판 제안 기능 |
| 정유진 | 잔디 및 팔로우 기능 |
| 김세인 | 듀오 게시판, 제안 기능 |

## 팀 내부 회의 진행 회차 및 일자

---

- 9회차(2024.03.26) 디스코드 회의
- 10회차(2024.03.27) 디스코드 회의
- 11회차(2024.03.28) 디스코드 회의
- 12회차(2024.03.29) 디스코드 회의
- 13회차(2024.03.30) 디스코드 회의
- 14회차(2024.03.31) 디스코드 회의

## 현재까지 개발 과정 요약 (최소 500자 이상)


   ### 정동은
  
    **인증, 회원 가입, 로그인**
  
    - 목표 달성률 100% / 코드 리팩토링하고 화면 정리
    - 회원 가입 시 api 이용하여 소환사 닉네임 확인할 때 puuid, tier 등 자주 필요한 정보는 가져와서 db에 저장해 둠.
    - 인증 실패로 뜨는 오류 해결. 조금만 바꿔도 사방에서 에러가 터지기 때문에 이제는 절대 건들지 않기로 마음 먹었다.
    
    **마이 페이지**
    
    - 목표 달성률 80% / 기본 유저 정보 수정 및 화면 구현
    - 유저 정보 수정, 비밀번호 수정 구현
    - 소환사 닉네임 수정 과정에서 라이엇 api로 검증. 이후 수정된 닉네임, 새로운 tier, puuid, profile 이미지 등 다시 저장
    - 마이 페이지에 들어가야 하는 뱃지, follow 기능과 결합 필요.
    - 기획 시 생각하지 못했던 부분(예를 들면 회원가입 시 puuid 저장)이 생기면 모든 코드에서 변화하는 부분이 있는지 확인하는 법을 배웠다. 회원 가입 시 db에 입력하는 정보가 추가되니 유저 정보 수정 시에도 추가되어야 하고, 유저 페이지의 update 시에도 그 정보를 새로운 정보로 변경해주어야 한다.
    
    **유저 페이지**
    
    - 목표 달성률 80% / api로 게임 전적 정보 대부분 가져옴.
    - 화면 만들고 게임 전적 정보는 대부분 받아서 보여줌. follow, 잔디, 뱃지 등과 합쳐야 함. 권한이나 인증에 따라서 다른 버튼 보여주는 기능 구현해야 함.
    - 네비게이션 따로 만들어서 각 페이지로 뿌려줌. 페이지마다 인증 정보 가져가야 함.
    - api를 화면에 뿌려주는 방법 자체는 어렵지 않았는데 각각 다른 데이터로 받아오는 많은 정보를 유저 페이지 하나에 다 넣으려니 좀 복잡했다. 코드가 많이 지저분하긴 하지만 일단 구현에 의의를 두려고 한다.
    
    **뱃지, 레벨 시스템**
    
    - 목표 달성률 30% / 기본 뱃지 코드 작성 및 생성 조건 정리
    - user-badge의 many to many 관계를 userBadge entity를 중간에 만들어서 처리함. 뱃지의 획득/미획득 상태와 생성 시간도 넣어주고 싶었기 때문.
    - 뱃지 획득을 위해 검증하는 과정을 언제 해야할 지 고민
        - 유저 정보 update시 검증하는 경우, update 시 저장하는 정보나 받아오는 api가 많아서 로딩이 오래 걸림
        - 매일 정해진 시간마다 검증하는 경우, 코드가 복잡해짐. 배포를 하거나 서버를 계속 켜둬야 함.
    
  ### 정유진
    - **Follow**
        - **Following & Follower 수 Count (목표 달성률 : 100%)**
        - **FollowRepository → follow, unfollow, follow 수 , userId == pageUserId 여부 확인 query 생성 (목표 달성률 : 100%)**
        - **user-page/{pageUserId} → user-page/{gameName}/{tagLine} 수정 (목표 달성률 : 100%)**
            - 개인으로 구현을 할 때에는 principalId == pageUserId 면 follow 관련 해서 구현을 진행하였으나 , 같은 user-page 작업하는 팀원과 회의를 해보았을 때 파라미터를 다르게 가져오는 것을 알았다.
            - pageUserId → gameName , tagLine 로 바꿔야하는 상황이었다.
            - query문을 이미 짜두었기 때문에 하나에서 두 개를 받아와야 하는 상황이 있어 곤란하였지만 , userService에 findByGameNameAndTagLine을 통해 userEntity 에 저장하고 entity 에서 id를 받아와 pageUserId에 저장을 하여 받아올 수 있었다.
        - **userPageId == principalId 일치 여부 확인 → 여부에 따른 회원 / 비회원 기능 활성화  (목표 달성률 : 100%)**
            - user-page에는 회원 / 비회원 여부에 따른 다른 정보가 표시되어야 한다. 
            프론트에서 ${dto.~}로 표현하는데 컨트롤러에서 회원이 아닌 사람들은 아예 받아오지 못하기 때문에 오류가 났었다.
            - 이를 해결하기 위해 컨트롤러에서 if ( userEntity ≠ null ) 문을 활용하여 else에 return을 해주었다.
            - 근데 여기서 또 ? sout 을 했을 땐 잘 나오지만 프론트 단에서 오류가 났다.
            
            ```jsx
            <small th:if="${dto.followingCount != null}" class="text-muted">following 
            <span th:text="${dto.followingCount}"></span></small>
            ```
            
            - 이걸 가져오려는데 찾지 못하였다.
            - 여기서의 오류 해결은
            
            ```jsx
            <small th:if="${dto?.followingCount != null}" class="text-muted">following
            <span th:text="${dto?.followingCount}"></span></small>
            ```
            
            - th:if ${dto ?. } 에서 `?.` 는 null일 경우 null 반환해 nullPointerException를 방지해주는 것을 배웠다!!
        - **pageUserId != userPageId면 pageOwnerState 여부에 따른 follow/차단 버튼 활성화 (목표 달성률 : 100%)**
            
            `?.`를 활용하여 금방 구현할 수 있었다.
            
        - **button 에 onclick 메서드 활용하여 follow , unfollow기능 구현  (목표 달성률 : 60%)**
            - query를 돌렸을 때는 follow, unfollow 가 되었다 .
            - 프론트단에서 버튼을 눌렀을 때 query 가 작동할 수 있게 구현을 하면 된다.
        - **modal/페이지에 following , follower 목록 뿌리기 ( 목표 달성률 : 30% )**
            - count 수 를 눌렀을 때 해당 follow 에 대한 목록을 가져와야 하는데 
            해당 userPageId의 following을 눌렀을 때는 following창을 띄운다.
            → 여기서 following 창에는 내가 follow를 하는 것이기 때문에 unfollow만 있으면 된다.
            - 반대로 follower를 눌렀을 때에는 userPageId.follower 목록을 나타내는데
            → 여기서는 나를 follow 한 사람이기 때문에 내가 안 했을 수도 있다.
            → 그래서 follow 버튼을 boolean followState에 따라 follow/ unfollow로 나눠야한다.
            - followState는 sout을 통하여 true, false로 찍는 건 확인을 하였다.
            - 위의 기능 구현 예정
    - **자체평가**
        
        Thymeleaf 가 아직 익숙하지 않아 front단에서 불러내기가 어려웠다.
        
        **그래도 ?.는 배워서 짜릿했다.** 
        
        query 문을 짤 때 한참 오류가 값을 찾을 수 없다길래 아무리 봐도 오타가 없어서 30분 끙끙거렸는데
        
        `**: pageUserId`  → `:pageUserId` 띄어쓰기였다... 오타만 보지말고 띄어쓰기도 잘보자 …. ㅋ..**
        
        붙히니까 금방 오류는 잡혔고 nativeQuery를 쓸 때에는 `@param` 이 필요하다는 것도 알게 되었다.
        
    
  ### 고기욱
    
    **Duo 게시판**
    
    Duo를 구하는 글을 볼 수 있고, 듀오 신청글을 작성, 또는 글에 신청을 할 수 있음
    
    1. Duo 게시판 전체 보기 (목표 달성률 : 80%)
        - 듀오 게시판에 들어가면 유저의 정보 (아직 미구현 → UserEntity를 이용해 불러올 예정) 가 나오며, 그 정보를 보고 마음에 들면 신청을 할 수 있음 (목표 달성률 85%)
            - 유저 정보를 가져오는 과정에서 유저의 챔피언 정보를 불러오는것을 어떻게 할지 고민중
                - 단순한 과정으로 불러오면 api를 너무 많이 사용할 것 같아 UserEntity에 MostChampion 칼럼을 만들어야 할 듯 ?
        - 회원은 듀오 구하기 글을 쓸 수 있음 (목표 달성률 100%)
            - 글을 작성하면 ‘구인중’ 인 글이 생성됨
            - ‘구인중’인 글이 있으면 새로운 글 생성 불가
        - 나의 글은 신청버튼이 나오지 않음 (목표 달성률 100%)
        - 신청을 하면 신청 취소를 할 수 있게 취소 버튼이 나옴 (목표 달성률 100%)
            - 신청을 취소하면 신청글 삭제
        - 글 작성자는 자신의 글로 들어가면 신청자들의 목록을 볼 수 있음 (신청자들의 정보는 아직 미구현 → 위와 같이 UserEntity를 이용해 불러올 예정) (목표 달성률 85%)
            - 지금은 게시글을 누르면 게시글에 들어가지지만, 추 후 내글 모아보기 에서 내 글만 볼 수 있는 페이지에서만 들어가지게 수정할 예정
        - 글 작성자는 신청자들의 정보를 보고 제안을 수락이나 거절을 할 수 있음(목표 달성률 85%)
        - 제안을 수락하면 매칭페이지로 넘어감 (목표 달성률 100%)
        - 매칭 페이지에서 유저정보를 띄우줘며 둘이 매칭되었다는 것을 표현해줌 (목표 달성률 50%)
            - 위와 마찬가지로 , UserEntity를 이용해 유저 정보를 불러올 예정
        - 매칭이 완료되면 서로간 점수를 줄 수 있는 시스템 구현 예정 (목표 달성률 0%)
            - 매칭이 완료되면
            - 위의 작업이 끝나면 진행
    
    **자체평가**
    
    Duo 페이지를 보여주는 과정에서 html 쪽에 많은 조건문을 생성했는데, 그 부분이 조금 힘들었다. 
    
    예를 들어서 게시글에 내가 신청을 했는지 보려면 특정 post 의 offer에서 신청한 사람의 pk를 가져와서 비교를해야하는데, 처음에 단순히 일치하면 true, false 로했더니 신청자가 10명이고 그 중 한명이 나였을 때, true 가 1개 false 가 9개 출력이 되었다
    
     이를 고치고자 내가 포함되어있으면 이라는 구문으로 바꾸는 과정에서 Thymeleaf 가 익숙하지 않아서 고생을 했다
    
    또한 CRUD를 하고, 그 정보를 원하는 곳에 원하는 방식으로 뿌려주는게 생각보다 꼬이는 경우가 많았다.
    
    그리고 기능들을 정리해두고 작업을 시작했다 생각했어도, 막상 작업하다보면 ‘아 이걸 안했내‘ 라는것들이 계속 나와서 기능들을 시뮬레이션 할 때 조금 더 구체적으로 해야 좋을 것 같다.
    
     
    
### 김세인
    
    Duo 게시판 
    Offer / Post 게시글, 답글 작성
    삭제 - 진행중
    

## 개발 과정에서 나왔던 질문 (최소 200자 이상)

---

### 권한에 따른 화면 보여주는 방식

- user-page는 누구나 접근 가능한 페이지이다. 그러나 user-page는 gameName과 tagLine을 이용해 모든 롤 유저의 정보를 api를 사용해 보여줄 수 있으므로 비회원의 user-page가 생성될 수 있다.
- 각각의 경우에 따라 다른 정보가  표시되어야 한다.

|  | following 수, 잔디, 뱃지 | follow, 차단 버튼 |
| --- | --- | --- |
| page 주인 - 회원 / 사용자 - 회원 | O | O |
| page 주인 - 회원  /사용자 - 비회원 | O | X |
| page 주인 - 비회원 / 사용자 - 회원 | X | X |
| page 주인 - 비회원 / 사용자 - 비회원 | X | X |
- page 주인이 회원인지 아닌지 구분
    - page의 gameName과 tagLine을 통해 db에 저장되었는지 확인
- 사용자가 회원인지 아닌지 구분
    - 로그인 된 사용자는 회원으로 생각함. Spring security 인증 여부에 따라서 구분.

### MySql 해킹 사건

- mySql db가 해킹 당해서 정보가 지워지고 해커가 비트코인을 요구했다. 깃허브 크롤링해서 무작위 해킹을 한다는 말을 들어보긴 했는데 실제로 겪으니 신기했다. 다행히 db에는 user1 정보만 들어있어서 피해는 없었다. 깃허브에 실수로 올렸던 yaml 파일의 비밀번호가 원인인 것 같다.
- 일단 중요한 정보는 없으니까 그대로 쓰다가 db에 저장할 일 생기면 비밀번호 변경하기로 했다.
- Secret Key 관리 잘하자!

## 개발 결과물 공유

---

Github Repository URL: Github Repository URL: https://github.com/NarooSister/lol_likelion_project
